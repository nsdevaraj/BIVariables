<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BI Configuration Builder</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <h1>BI Configuration Builder</h1>
            <div class="header-actions">
                <button id="testModeBtn" class="btn btn--secondary btn--sm">Test Mode</button>
                <button id="saveConfigBtn" class="btn btn--primary btn--sm">Save Config</button>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Left: Workspace -->
            <section class="workspace">
                <div class="workspace-header">
                    <h3>Visual Elements</h3>
                    <button id="addElementBtn" class="btn btn--primary btn--sm">+ Add Element</button>
                </div>
                <div id="elementsGrid" class="elements-grid">
                    <!-- JS will populate this -->
                </div>
            </section>

            <!-- Right: Sidebar with Tabs -->
            <aside class="sidebar">
                <div class="sidebar-tabs">
                    <button class="sidebar-tab-btn active" data-panel="variables">Variables</button>
                    <button class="sidebar-tab-btn" data-panel="properties">Properties</button>
                    <button class="sidebar-tab-btn" data-panel="events">Events</button>
                    <button class="sidebar-tab-btn" data-panel="states">States</button>
                </div>
                
                <!-- Variables Panel -->
                <div id="variablesPanel" class="sidebar-panel active">
                    <div class="sidebar-header">
                        <h3>Global Variables</h3>
                        <button id="addVariableBtn" class="btn btn--primary btn--sm">+ Add</button>
                    </div>
                    <div class="search-box">
                        <input type="text" id="variableSearch" class="form-control" placeholder="Search...">
                    </div>
                    <div id="variablesList" class="item-list"></div>
                </div>

                <!-- Properties Panel -->
                <div id="propertiesPanel" class="sidebar-panel">
                    <div class="sidebar-header">
                        <h3>Properties</h3>
                        <span id="selectionIndicator">No selection</span>
                    </div>
                    <div id="propertiesContent" class="properties-content"></div>
                </div>

                <!-- Events Panel -->
                <div id="eventsPanel" class="sidebar-panel">
                    <div class="sidebar-header">
                        <h3>Events</h3>
                        <button id="addEventBtn" class="btn btn--primary btn--sm">+ Add</button>
                    </div>
                    <div id="eventsList" class="item-list"></div>
                </div>

                <!-- States Panel -->
                <div id="statesPanel" class="sidebar-panel">
                    <div class="sidebar-header">
                        <h3>States</h3>
                        <button id="addStateBtn" class="btn btn--primary btn--sm">+ Add</button>
                    </div>
                    <div id="statesList" class="item-list"></div>
                </div>
            </aside>
        </main>
    </div>

    <!-- Modals (Original, Unchanged) -->
    <!-- Variable Modal -->
    <div class="modal" id="variableModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="variableModalTitle">Add Variable</h3>
                <button class="modal-close" id="closeVariableModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="variableForm">
                    <div class="form-group">
                        <label class="form-label" for="variableName">Name</label>
                        <input type="text" class="form-control" id="variableName" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="variableType">Type</label>
                        <select class="form-control" id="variableType">
                            <option value="String">üìù String</option>
                            <option value="Number">üî¢ Number</option>
                            <option value="NumberVariable">üìä KPI</option>
                            <option value="Boolean">‚òëÔ∏è Boolean</option>
                            <option value="Date">üìÖ Date</option>
                            <option value="Array">üìö Array</option>
                            <option value="Object">üóÇÔ∏è Object</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="variableDefault">Default Value</label>
                        <input type="text" class="form-control" id="variableDefault">
                    </div>
                    <div id="numberVariableFields" style="display: none;">
                        <div class="form-group">
                            <label class="form-label" for="thresholdVariable">Threshold Variable (Optional)</label>
                            <select class="form-control" id="thresholdVariable"><option value="">No threshold</option></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="budgetVariable">Budget Variable (Optional)</label>
                            <select class="form-control" id="budgetVariable"><option value="">No budget</option></select>
                        </div>
                        <div class="form-group">
                            <label class="form-label" for="thresholdSource">Threshold Source</label>
                            <select class="form-control" id="thresholdSource">
                                <option value="fixed">Fixed Value</option>
                                <option value="budgetValue">Budget Value</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="form-label" for="variableDescription">Description</label>
                        <textarea class="form-control" id="variableDescription" rows="3"></textarea>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" id="cancelVariableBtn">Cancel</button>
                <button class="btn btn--primary" id="saveVariableBtn">Save</button>
            </div>
        </div>
    </div>

    <!-- Element Modal -->
    <div class="modal" id="elementModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Add Visual Element</h3>
                <button class="modal-close" id="closeElementModal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="element-types">
                    <div class="element-type" data-type="Chart"><span class="element-icon">üìä</span><span class="element-name">Chart</span></div>
                    <div class="element-type" data-type="KPI"><span class="element-icon">üìà</span><span class="element-name">KPI Card</span></div>
                    <div class="element-type" data-type="Filter"><span class="element-icon">üîΩ</span><span class="element-name">Filter</span></div>
                    <div class="element-type" data-type="Table"><span class="element-icon">üìã</span><span class="element-name">Table</span></div>
                    <div class="element-type" data-type="Button"><span class="element-icon">üîò</span><span class="element-name">Button</span></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Event Modal -->
    <div class="modal" id="eventModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="eventModalTitle">Add Event</h3>
                <button class="modal-close" id="closeEventModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="eventForm">
                    <div class="form-group"><label for="eventName">Event Name</label><input type="text" id="eventName" class="form-control" required></div>
                    <div class="form-group"><label for="eventElement">Element</label><select id="eventElement" class="form-control" required></select></div>
                    <div class="form-group"><label for="eventTrigger">Trigger</label><select id="eventTrigger" class="form-control"></select></div>
                    <div class="form-group"><label for="eventAction">Action</label><select id="eventAction" class="form-control"><option value="update_variable">Update Variable</option><option value="toggle_variable">Toggle Variable</option></select></div>
                    <div class="form-group"><label for="eventTarget">Target Variable</label><select id="eventTarget" class="form-control"></select></div>
                    <div class="form-group" id="updateValueGroup"><label for="eventValue">New Value</label><input type="text" id="eventValue" class="form-control"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" id="cancelEventBtn">Cancel</button>
                <button class="btn btn--primary" id="saveEventBtn">Save Event</button>
            </div>
        </div>
    </div>

    <!-- State Modal -->
    <div class="modal" id="stateModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="stateModalTitle">Add State</h3>
                <button class="modal-close" id="closeStateModal">&times;</button>
            </div>
            <div class="modal-body">
                <form id="stateForm">
                    <div class="form-group"><label for="stateName">State Name</label><input type="text" id="stateName" class="form-control" required></div>
                    <div class="form-group"><label for="stateVariable">Variable</label><select id="stateVariable" class="form-control"></select></div>
                    <div class="form-group"><label for="stateOperator">Condition</label><select id="stateOperator" class="form-control"><option value="==">Equals</option><option value="!=">Not Equals</option><option value=">">Greater Than</option><option value="<">Less Than</option></select></div>
                    <div class="form-group"><label for="compareType">Compare Against</label><select id="compareType" class="form-control"><option value="value">Value</option><option value="variable">Variable</option></select></div>
                    <div class="form-group" id="valueGroup"><label for="stateValue">Value</label><input type="text" id="stateValue" class="form-control" required></div>
                    <div class="form-group" id="variableGroup" style="display: none;"><label for="compareVariable">Compare Variable</label><select id="compareVariable" class="form-control"></select></div>
                    <div id="stateChangesList"></div>
                </form>
            </div>
            <div class="modal-footer">
                <button class="btn btn--secondary" id="cancelStateBtn">Cancel</button>
                <button class="btn btn--primary" id="saveStateBtn">Save State</button>
            </div>
        </div>
    </div>

    <!-- Test Modal -->
    <div class="modal" id="testModal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h3>Test Mode</h3>
                <button class="modal-close" id="closeTestModal">&times;</button>
            </div>
            <div class="modal-body" style="display: flex; gap: 1rem;">
                <div style="flex: 1;">
                    <h4>Simulate Events</h4>
                    <div id="testButtons"></div>
                </div>
                <div style="flex: 1;">
                    <h4>Variables Monitor</h4>
                    <div id="variablesMonitor"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
